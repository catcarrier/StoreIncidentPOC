<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_sg_write_back_action_item">
    <sys_sg_write_back_action_item action="INSERT_OR_UPDATE">
        <description/>
        <execution_script><![CDATA[(function WriteBackAction(input) {
    // Delete related rows first, then delete the incident
	// Important! deleteMultiple does not delete attachments.
    var gr_vehicle = new GlideRecord("x_42999_store_inc_vehicle");
    var gr_suspect = new GlideRecord("x_42999_store_inc_suspect");
    var gr_police = new GlideRecord("x_42999_store_inc_police_response");
    var gr_sku = new GlideRecord("x_42999_store_inc_sku");
    var gr_witness = new GlideRecord("x_42999_store_inc_witness");
    var gr_incident = new GlideRecord("x_42999_store_inc_incident");

    if (gr_vehicle.canDelete() && gr_suspect.canDelete() && gr_police.canDelete() && gr_sku.canDelete() && gr_witness.canDelete() && gr_incident.canDelete()) {
		gr_vehicle.addQuery("u_parent", input.sys_id);
		gr_vehicle.query();
        gr_vehicle.deleteMultiple();
		
        gr_suspect.addQuery("u_parent", input.sys_id);
		gr_suspect.query();
        gr_suspect.deleteMultiple();
		
        gr_police.addQuery("u_parent", input.sys_id);
		gr_police.query();
        gr_police.deleteMultiple();
		
        gr_sku.addQuery("u_parent", input.sys_id);
		gr_sku.query();
        gr_sku.deleteMultiple();
		
        gr_witness.addQuery("u_parent", input.sys_id);
		gr_witness.query();
        gr_witness.deleteMultiple();

		if(gr_incident.get("sys_id", input.sys_id)) {
			gr_incident.deleteRecord();
		}
    } else {
		gs.addErrorMessage("You are not allowed to delete from one or more of these tables.");
	}

})(input);]]></execution_script>
        <name>Delete Swipe Incident</name>
        <query_condition/>
        <sys_class_name>sys_sg_write_back_action_item</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2020-10-12 15:12:04</sys_created_on>
        <sys_id>116fd2712f7310109e9157892799b67e</sys_id>
        <sys_mod_count>11</sys_mod_count>
        <sys_name>Delete Swipe Incident</sys_name>
        <sys_package display_value="Store Incidents POC" source="x_42999_store_inc">4823ba6b2f2310109e9157892799b604</sys_package>
        <sys_policy/>
        <sys_scope display_value="Store Incidents POC">4823ba6b2f2310109e9157892799b604</sys_scope>
        <sys_update_name>sys_sg_write_back_action_item_116fd2712f7310109e9157892799b67e</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2020-10-15 19:57:32</sys_updated_on>
        <table/>
        <template/>
        <type>script</type>
        <use_current_record_as_condition>true</use_current_record_as_condition>
        <use_fields_for_ref_lookup>false</use_fields_for_ref_lookup>
    </sys_sg_write_back_action_item>
    <sys_translated_text action="delete_multiple" query="documentkey=116fd2712f7310109e9157892799b67e"/>
</record_update>
